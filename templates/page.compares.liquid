{{ page.content }}
{% assign product_info_json = page.metafields.global.comparison_parameters.value %}
<script>
  var allProductInfo = {{ product_info_json | json }}; 
  console.log(allProductInfo)
</script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    var params = new URLSearchParams(window.location.search);
    var productHandle = params.get('handle');

    if (productHandle && allProductInfo[productHandle]) {
      var productData = allProductInfo[productHandle];
      // 在这里处理和显示产品信息
      console.log("Product Title: " + productData.title);
      // 更多代码来展示产品信息...
    } else {
      console.log("Product handle not found or no data available for this handle.");
    }
  });
</script>

<script>
var productMetafields = {};

$(document).ready(function() {
    var params = new URLSearchParams(window.location.search);
    var productHandle = params.get('handle');
    console.log(productHandle)
    if (productHandle) {
        fetchProductInfoByHandle(productHandle);
    }
});

function fetchProductInfoByHandle(handle) {
    $.get('/products/' + handle + '.js', function(product) {
        console.log("Product data:", product);

        if (product.metafields && product.metafields.global && product.metafields.global.comparison_parameters) {
            try {
                var metafieldsData = JSON.parse(product.metafields.global.comparison_parameters.value);
                productMetafields[handle] = metafieldsData;
                console.log("Metafields data:", metafieldsData);
            } catch (e) {
                console.error("Error parsing Metafields JSON:", e);
            }
        } else {
            console.log("No Metafields data found for handle:", handle);
        }
    }).fail(function() {
        console.error("Error fetching product information for handle:", handle);
    });
}

</script>
