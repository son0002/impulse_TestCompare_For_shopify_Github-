{{ page.content }}
<h2 style="text-align: center;">{{page.title}}</h2>
<style>
    .product-list {
        list-style: none;
        padding: 0;
        display: flex;
        flex-wrap: wrap;
        justify-content: flex-start;
    }

    .product {
        margin: 10px;
        flex: 0 0 calc(25% - 20px);
        /* 每个产品宽度为 25% - margin */
        box-sizing: border-box;
        /* 包括边框在内的宽度计算 */
    }

    .product-header {
        text-align: center;
    }

    .product-header img {
        max-width: 100%;
        /* 图片最大宽度为 100% */
        height: auto;
    }

    .product-title {
        font-size: 16px;
        font-weight: bold;
    }

    .product-params span {
        display: block;
        text-align: center;
        margin: 3px 0;
        border: 1px solid #ddd;
        padding: 7px 0;
    }

    @media (max-width: 1200px) {
        .product {
            flex: 0 0 calc(33.33% - 20px);
            /* 在屏幕较小的情况下，每个产品宽度为 33.33% - margin */
        }
    }

    @media (max-width: 800px) {
        .product {
            flex: 0 0 calc(50% - 20px);
            /* 在屏幕更小的情况下，每个产品宽度为 50% - margin */
        }
    }

    @media (max-width: 600px) {
        .product {
            flex: 0 0 calc(100% - 20px);
            /* 在屏幕非常小的情况下，每个产品宽度为 100% - margin */
        }
    }
</style>
<div class="page-width">
    <div id="whereToPlaceSelect">

    </div>
    <ul class="product-list">

    </ul>
</div>
{% assign product_info_json = page.metafields.global.comparison_parameters.value %}
<script>
    var allProductInfo = {{ product_info_json | json }};

    document.addEventListener('DOMContentLoaded', function () {
        var params = new URLSearchParams(window.location.search);
        var productHandles = params.get('handles');

        if (productHandles) {
            var handlesArray = productHandles.split(',');
            handlesArray.forEach(function (handle) {
                fetchProductInfoByHandle(handle);
            });
        } else {
            console.log("No product handles found in the URL.");
        }
    });

    function fetchProductInfoByHandle(handle) {
        $.get('/products/' + handle + '.js', function (response) {
            // console.log(product)
            var product = JSON.parse(response);
            console.log(product.title)
            var productHtml = '<li class="product">' +
                '<div class="product-header">' +
                '<img src="' + product.featured_image + '" alt="' + product.title + '">' +
                '<div class="product-title">' + product.title + '</div>' +
                '</div>';

            if (allProductInfo[handle]) {
                var productParamsHtml = '<div class="product-params">';
                Object.keys(allProductInfo[handle]).forEach(function (key) {
                    productParamsHtml += '<span>' + key + ': ' + allProductInfo[handle][key] + '</span>';
                });
                productParamsHtml += '</div>';
                productHtml += productParamsHtml;
            }

            productHtml += '</li>';
            $('.product-list').append(productHtml);
        }).fail(function () {
            console.error("Error fetching product information for handle:", handle);
        });
    }


    $.get('/collections/wood-pellet-grills/products.json', function (data) {
        var products = data.products;
        var selectHtml = '<select id="productSelect">';

        products.forEach(function (product) {
            selectHtml += '<option value="' + product.handle + '">' + product.title + '</option>';
        });

        selectHtml += '</select>';
        $('#whereToPlaceSelect').html(selectHtml);
    }).fail(function () {
        console.error("Error fetching products from the collection");
    });

    $('#productSelect').on('change', function() {
    var selectedHandle = $(this).val();
    console.log(selectedHandle)
    console.log(allProductInfo)
    if (allProductInfo[selectedHandle]) {
        var productData = allProductInfo[selectedHandle];
        // 在这里处理和展示选中产品的数据
        console.log(productData);
    }
});



</script>