{{ page.content }}

<script>
var productMetafields = {};

$(document).ready(function() {
    var params = new URLSearchParams(window.location.search);
    var productHandle = params.get('handle');
    console.log(productHandle)
    if (productHandle) {
        fetchProductInfoByHandle(productHandle);
    }
});

function fetchProductInfoByHandle(handle) {
    $.get('/products/' + handle + '.js', function(product) {
        console.log("Product data:", product);

        if (product.metafields && product.metafields.global && product.metafields.global.comparison_parameters) {
            try {
                var metafieldsData = JSON.parse(product.metafields.global.comparison_parameters.value);
                productMetafields[handle] = metafieldsData;
                console.log("Metafields data:", metafieldsData);
            } catch (e) {
                console.error("Error parsing Metafields JSON:", e);
            }
        } else {
            console.log("No Metafields data found for handle:", handle);
        }
    }).fail(function() {
        console.error("Error fetching product information for handle:", handle);
    });
}

</script>
